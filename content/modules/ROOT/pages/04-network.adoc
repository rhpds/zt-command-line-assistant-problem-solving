:imagesdir: ../assets/images

== Configure DNS and port redirection

The command line assistant is useful for configuring and troubleshooting
RHEL networking. In this assignment we’ll use command line assistant to
help us configure DNS as well as port redirection.

== Configuring DNS

Let’s ask command line assistant what our DNS is configured to.

[source,bash,run]
----
c "how do I determine my dns server in rhel10"
----

The output should look something like this.

.View DNS
image::view_dns.png[../assets/view_dns]

Let’s run the suggested command.

[source,bash,run]
----
cat /etc/resolv.conf
----

The output will look like this.

.View DNS
image::view_dns2.png[../assets/view_dns]

Let’s add another DNS server.

[source,bash,run]
----
c "how do I configure the dns server to 8.8.8.8 from the command line?"
----

The output will look like this.

.Configure DNS
image::cla_configure_dns.png[../assets/cla_configure_dns]

When you run `+nmcli connection show+`, multiple connections are
returned.

[source,bash,run]
----
nmcli connection show
----

.Nmcli connection show
image::nmcli_con_show.png[../assets/nmcli_con_show]

How do I know what connection to configure?

Let’s see what connection is currently the default gateway and which NIC
is being used.

[source,bash,run]
----
c "what is my default gateway"
----

.Default gateway
image::default_gateway.png[../assets/default_gateway]

Let’s run `+ip route | grep default+`.

[source,bash,run]
----
ip route | grep default
----

Here’s the output.

[source,bash,nocopy]
----
root@rhel:~# ip route | grep default
default via 10.5.0.1 dev eth0 proto dhcp src 10.5.0.92 metric 100
----

We can see that the default route is set for eth0. eth0 is configured to
`+Wired connection 1+`.

As per the instructions above, run the following command to configure
the new DNS server.

[source,bash,run]
----
nmcli connection modify Wired\ connection\ 1 ipv4.dns 8.8.8.8
----

Then we need to activate the connection.

[source,bash,run]
----
nmcli connection up Wired\ connection\ 1
----

Check the results.

[source,bash,run]
----
cat /etc/resolv.conf
----

We can see that `+8.8.8.8+` is now configured as a DNS server.

.8888 DNS
image::8888_dns.png[../assets/8888_dns]
